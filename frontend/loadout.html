<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <title>Alege Flota</title>
    <style>
        /* Un pic de stilizare sa arate bine */
        body { background-color: #2c3e50; color: white; font-family: sans-serif; text-align: center; }
        .container { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; padding: 20px; }

        .ship-card {
            border: 2px solid #e67e22;
            border-radius: 10px;
            padding: 10px;
            width: 200px;
            cursor: pointer;
            transition: 0.3s;
            background: #34495e;
        }

        .ship-card:hover { transform: scale(1.05); }

        /* Cand o nava e selectata, se face verde */
        .selected {
            border-color: #2ecc71;
            background-color: #27ae60;
            box-shadow: 0 0 15px #2ecc71;
        }

        img { width: 100%; border-radius: 5px; }
    </style>
</head>
<body>

<h1>Alege 4 Nave pentru Luptă!</h1>
<h3 id="count-display">Selectate: 0 / 4</h3>

<div class="container" id="ships-container">
    <p>Se încarcă navele...</p>
</div>

<button onclick="saveLoadout()" style="margin-top: 20px; padding: 15px 30px; background: #e67e22; border: none; color: white; font-size: 18px; cursor: pointer;">SALVEAZĂ FLOTA</button>

<script>
    // --- AICI ESTE LEGAREA CU JAVA ---

    let selectedShips = []; // Lista unde tinem minte ce a ales userul

    // 1. Cand se deschide pagina, cerem datele de la Java
    window.onload = async function() {
        try {
            // "fetch" este comanda care suna la backend
            const response = await fetch('/api/ships');
            const ships = await response.json();

            displayShips(ships); // Trimitem datele la functia de desenare
        } catch (error) {
            console.error("Eroare la incarcare:", error);
            document.getElementById('ships-container').innerHTML = "<p>Nu am putut conecta la serverul Java :(</p>";
        }
    };

    // 2. Functia care deseneaza cartonașele
    function displayShips(ships) {
        const container = document.getElementById('ships-container');
        container.innerHTML = ''; // Curatam mesajul de incarcare

        ships.forEach(ship => {
            // Cream HTML pentru fiecare nava
            const card = document.createElement('div');
            card.className = 'ship-card';
            card.onclick = () => toggleSelection(card, ship.id); // Adaugam click

            card.innerHTML = `
                    <img src="${ship.imageUrl}" alt="${ship.name}">
                    <h3>${ship.name}</h3>
                    <p>Mărime: ${ship.size} pătrățele</p>
                `;

            container.appendChild(card);
        });
    }

    // 3. Logica de selectie (Click pe nava)
    function toggleSelection(cardElement, shipId) {
        // Daca e deja selectata, o scoatem
        if (selectedShips.includes(shipId)) {
            selectedShips = selectedShips.filter(id => id !== shipId);
            cardElement.classList.remove('selected');
        } else {
            // Daca nu e selectata, verificam sa nu avem deja 4
            if (selectedShips.length >= 4) {
                alert("Poți alege maxim 4 nave!");
                return;
            }
            selectedShips.push(shipId);
            cardElement.classList.add('selected');
        }

        // Actualizam textul de sus
        document.getElementById('count-display').innerText = `Selectate: ${selectedShips.length} / 4`;
    }

    // 4. Salvarea (doar un test momentan)
    function saveLoadout() {
        if (selectedShips.length !== 4) {
            alert("Te rog alege exact 4 nave înainte să pleci la luptă!");
            return;
        }
        console.log("Navele alese:", selectedShips);
        alert("Flota salvată! ID-uri: " + selectedShips.join(", "));
        // Aici vom trimite datele inapoi la Java mai tarziu
    }
</script>

</body>
</html>