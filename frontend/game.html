<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <title>Battle Boats - Arena</title>
    <link rel="stylesheet" href="game.css">
</head>
<body class="game-layout">
<div class="game-container">
    <div class="header">
        <div class="top-bar">
            <button onclick="goBack()" class="btn-back">⬅ Înapoi la Meniu</button>
        </div>
        <h2>Faza de Pregătire</h2>
        <p style="font-size: 0.9em; color: #bdc3c7;">
            Trage navele pe tablă.
            <b>Click Dreapta</b> pe o navă plasată pentru a o șterge.
        </p>
        <button id="confirm-btn" onclick="confirmPlacement()" disabled>Gata de Luptă</button>
    </div>

    <div class="setup-area">
        <div class="board-section">
            <div id="my-board" class="board"></div>
        </div>
    </div>

    <div class="dock-container" id="dock">
        <p id="loading-ships">Se încarcă flota salvată de pe server...</p>
    </div>
</div>

<script src="config.js"></script>
<script type="module">
    import {
        auth,
        getUserSkins,
        joinOrCreateGame,
        getMyActiveGameId,
        waitForAuthReady,
        leaveMatchQueueIfWaiting,
    } from './firebase.js';

    window.__bb_fb_game = {
        getCurrentUser: () => auth.currentUser,
        waitForAuthReady,
        getUserSkins,
        joinOrCreateGame,
        getMyActiveGameId,
        leaveMatchQueueIfWaiting,
    };

    // Best-effort cleanup if user leaves the page while waiting in queue.
    // Note: browsers may kill async work on unload, but this still helps a lot.
    window.addEventListener('pagehide', () => {
        const uid = localStorage.getItem('battleboats_userid');
        if (uid) leaveMatchQueueIfWaiting(uid);
    });
</script>
<script src="game.js"></script>
</body>
</html>